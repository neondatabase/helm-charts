{{- if ne .Values.settings.domain "dummy" }}
  {{- if .Values.useCertManager }}
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: {{ include "neon-pg-sni-router.certificate" . }}
spec:
  commonName: {{ .Values.settings.domain | quote }}
  dnsNames:
  - {{ .Values.settings.domain | quote }}
  issuerRef:
    group: cert-manager.io
    kind: ClusterIssuer
    name: cert-manager-clusterissuer
  secretName: {{ include "neon-pg-sni-router.certificate-secret" . }}
  privateKey:
    encoding: PKCS8
  {{- end }}
{{ else }}
{{/*  this is a dummy certificate to make tests pass */}}
apiVersion: v1
kind: Secret
metadata:
  name: dummy-tls
type: kubernetes.io/tls
data:
  tls.crt: >-
    LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZUakNDQkRhZ0F3SUJBZ0lTQTdFT3RQTGRXRzUwbzBEeVBzaDl1bktTTUEwR0NTcUdTSWIzRFFFQkN3VUEKTURJeEN6QUpCZ05WQkFZVEFsVlRNUll3RkFZRFZRUUtFdzFNWlhRbmN5QkZibU55ZVhCME1Rc3dDUVlEVlFRRApFd0pTTXpBZUZ3MHlNekEwTWpZeE16RXdNemRhRncweU16QTNNalV4TXpFd016WmFNQzR4TERBcUJnTlZCQU1NCkl5b3VjMjVwY205MWRHVnlMbWg1WkhKdloyVnVMbUYzY3k1dVpXOXVMbUoxYVd4a01JSUJJakFOQmdrcWhraUcKOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXNmZllVc21UNW5EM0EzRS9qTTJkTG11MmVjSFd1TXRzWjdBUQpMUzlhS05iYjFZZTNiOUtzNmx5a0VxbDdZaG1CVXB4UE9CUGVBZkpiT0Iycy9yU2NwVWIrdlVBQW9mSFNlU3IyCnBzT2lHV3BOUzBKSWxaZXA2MmlFN212Vkl0ZjdjYVR2SWxQNHRkZUo2S2lUV09tMGZFUUlZa1FRNzdFdVMyQmYKbGNOaThKblN6THV4WHVONWo2eW92RHN4K25GbDErUXZxRXZ6dk9WYWd5eks4bDRNc3JJS05FbkRVRE9KZ2hsYwpyR3B4eGRZQyszamxYcElpVDFwNHE0Tno5aHRGa0taN2FEZHI2d2s2T0haM1dUd0Nqd3dnTWlxU2hFcG5xTVoyCkRURDRCL1R2ODJIYTRNNS8vakpUQzVPem5NejhoaklJaXlBdDh2T0Q4TWl0Y0NjeEdRSURBUUFCbzRJQ1lEQ0MKQWx3d0RnWURWUjBQQVFIL0JBUURBZ1dnTUIwR0ExVWRKUVFXTUJRR0NDc0dBUVVGQndNQkJnZ3JCZ0VGQlFjRApBakFNQmdOVkhSTUJBZjhFQWpBQU1CMEdBMVVkRGdRV0JCUkVlbTVXV3JWcW4zdDljdXpDWHhPQ3N3c3JuekFmCkJnTlZIU01FR0RBV2dCUVVMck1YdDFoV3k2NVFDVURtSDYrZGl4VEN4akJWQmdnckJnRUZCUWNCQVFSSk1FY3cKSVFZSUt3WUJCUVVITUFHR0ZXaDBkSEE2THk5eU15NXZMbXhsYm1OeUxtOXlaekFpQmdnckJnRUZCUWN3QW9ZVwphSFIwY0RvdkwzSXpMbWt1YkdWdVkzSXViM0puTHpBdUJnTlZIUkVFSnpBbGdpTXFMbk51YVhKdmRYUmxjaTVvCmVXUnliMmRsYmk1aGQzTXVibVZ2Ymk1aWRXbHNaREJNQmdOVkhTQUVSVEJETUFnR0JtZUJEQUVDQVRBM0Jnc3IKQmdFRUFZTGZFd0VCQVRBb01DWUdDQ3NHQVFVRkJ3SUJGaHBvZEhSd09pOHZZM0J6TG14bGRITmxibU55ZVhCMApMbTl5WnpDQ0FRWUdDaXNHQVFRQjFua0NCQUlFZ2ZjRWdmUUE4Z0IzQUxjKyt5VGZuRTI2ZGZJNXhicFk5R3hkCi9FTFBlcDgxeEo0ZENZRWw3YlNaQUFBQmg3M200U01BQUFRREFFZ3dSZ0loQUsweSs2SmVwZXJ0YWF4a3BVd0kKSy9ISUdqdG5TckdIZ1RFQ3dPMkk2alJzQWlFQXFwdHJvcWJoY2M5eFk5bElLVE5IbUQ1QlFpRlJwZnRkdThPdwpUclRkcjMwQWR3QjZNb3hVMkxjdHRpRHFPT0JTSHVtRUZuQXlFNFZOTzlJcndUcFhvMUxyVWdBQUFZZTk1dUZFCkFBQUVBd0JJTUVZQ0lRQ0VEL2wrOFBtMzVsdUgvbjdOSXpMMjhiaEJOQjdDSEhCbVU4OG84TEIrNWdJaEFQZVgKOVVNdkl6djFZSFdiYzJjbEVYczY1WHFwWHpNSkh4cG1tYVBUczI2UE1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQgpBUUNhNjlQUmRWdWx6Q3pVOUl2SzBOd3hTZWJGTGxPclNTcVN1NG5xN2FvQzZLVndoTGc3eFVOcVh5Z0RldU1iCmRaNU9aQWZ0YzFyNitncXRabUFtTlh4M3pHOCtMcnl5dXBVNzZSeGNybW5oaFQ4R1pSN3A1VHQyUnRZM0YrQzYKaytlWUhiaGF4WXp0THYwaVAvalMzcHNISEk0end3ZHNBcFZya3VERzRsTHlsd2pvc3VFVnJFMVYvbHpXeVRuQwprbG5IL040RXdObm5zTFo3TUhpV2dLWUVtdTFjc3IwNWw1aGdnOTM4VUxMcWx2S0d0a1lQYk9JbWxyVVkwdURuCjJCeHNnbXFyQmYrY3krR0dnZ2lOZ2RzVUhoUVZJK1dOSS9NVi81OUJFOGRhNzczVkpmWEhDTUpGM2dCSU1NdlAKaXEzS1hXK3d0K0ZEMExLbjc2VnFHUDJJCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZGakNDQXY2Z0F3SUJBZ0lSQUpFckNFclBEQmluVS9iV0xpV25YMW93RFFZSktvWklodmNOQVFFTEJRQXcKVHpFTE1Ba0dBMVVFQmhNQ1ZWTXhLVEFuQmdOVkJBb1RJRWx1ZEdWeWJtVjBJRk5sWTNWeWFYUjVJRkpsYzJWaApjbU5vSUVkeWIzVndNUlV3RXdZRFZRUURFd3hKVTFKSElGSnZiM1FnV0RFd0hoY05NakF3T1RBME1EQXdNREF3CldoY05NalV3T1RFMU1UWXdNREF3V2pBeU1Rc3dDUVlEVlFRR0V3SlZVekVXTUJRR0ExVUVDaE1OVEdWMEozTWcKUlc1amNubHdkREVMTUFrR0ExVUVBeE1DVWpNd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFSwpBb0lCQVFDN0FoVW96UGFnbE5NUEV1eU5WWkxEK0lMeG1hWjZRb2luWFNhcXRTdTV4VXl4cjQ1citYWElvOWNQClI1UVVWVFZYako2b29qa1o5WUk4UXFsT2J2VTd3eTdiamNDd1hQTlpPT2Z0ejJud1dnc2J2c0NVSkNXSCtqZHgKc3hQbkhLemhtKy9iNUR0RlVrV1dxY0ZUempUSVV1NjFydTJQM21CdzRxVlVxN1p0RHBlbFFEUnJLOU84WnV0bQpOSHo2YTR1UFZ5bVorREFYWGJweWIvdUJ4YTNTaGxnOUY4Zm5DYnZ4Sy9lRzNNSGFjVjNVUnVQTXJTWEJpTHhnClozVm1zL0VZOTZKYzVsUC9Pb2kyUjZYL0V4anFtQWwzUDUxVCtjOEI1ZldtY0JjVXIyT2svNW16azUzY1U2Y0cKL2tpRkhhRnByaVYxdXhQTVVnUDE3VkdoaTlzVkFnTUJBQUdqZ2dFSU1JSUJCREFPQmdOVkhROEJBZjhFQkFNQwpBWVl3SFFZRFZSMGxCQll3RkFZSUt3WUJCUVVIQXdJR0NDc0dBUVVGQndNQk1CSUdBMVVkRXdFQi93UUlNQVlCCkFmOENBUUF3SFFZRFZSME9CQllFRkJRdXN4ZTNXRmJMcmxBSlFPWWZyNTJMRk1MR01COEdBMVVkSXdRWU1CYUEKRkhtMFdlWjd0dVhrQVhPQUNJaklHbGoyNlp0dU1ESUdDQ3NHQVFVRkJ3RUJCQ1l3SkRBaUJnZ3JCZ0VGQlFjdwpBb1lXYUhSMGNEb3ZMM2d4TG1rdWJHVnVZM0l1YjNKbkx6QW5CZ05WSFI4RUlEQWVNQnlnR3FBWWhoWm9kSFJ3Ck9pOHZlREV1WXk1c1pXNWpjaTV2Y21jdk1DSUdBMVVkSUFRYk1Ca3dDQVlHWjRFTUFRSUJNQTBHQ3lzR0FRUUIKZ3Q4VEFRRUJNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUNBUUNGeWs1SFBxUDNoVVNGdk5WbmVMS1lZNjExVFI2VwpQVE5sY2xRdGdhRHF3KzM0SUw5ZnpMZHdBTGR1Ty9aZWxON2tJSittNzR1eUErZWl0Ulk4a2M2MDdUa0M1M3dsCmlrZm1aVzQvUnZUWjhNNlVLKzVVemhLOGpDZEx1TUdZTDZLdnpYR1JTZ2kzeUxnamV3UXRDUGtJVno2RDJRUXoKQ2tjaGVBbUNKOE1xeUp1NXpsenlaTWpBdm5uQVQ0NXRSQXhla3JzdTk0c1E0ZWdkUkNuYldTRHRZN2toK0JJbQpsSk5Yb0IxbEJNRUtJcTRRRFVPWG9SZ2ZmdURnaGplMVdyRzlNTCtIYmlzcS95Rk9Hd1hEOVJpWDhGNnN3Nlc0CmF2QXV2RHN6dWU1TDNzejg1SytFQzRZL3dGVkROdlpvNFRZWGFvNlowZitsUUtjMHQ4RFFZemsxT1hWdThycDIKeUpNQzZhbExiQmZPREFMWnZZSDduN2RvMUFabHM0STlkMVA0am5rRHJRb3hCM1VxUTloVmwzTEVLUTczeEYxTwp5SzVHaEREWDhvVmZHS0Y1dStkZWNJc0g0WWFUdzdtUDNHRnhKU3F2MyswbFVGSm9pNUxjNWRhMTQ5cDkwSWRzCmhDRXhyb0wxKzdtcnlJa1hQZUZNNVRnTzlyMHJ2WmFCRk92VjJ6MGdwMzVaMCtMNFdQbGJ1RWpOL2x4UEZpbisKSGxVanI4Z1JzSTNxZkpPUUZ5LzlyS0lKUjBZLzhPbXd0LzhvVFdneTFtZGVIbW1qazdqMW5Zc3ZDOUpTUTZadgpNbGRsVFRLQjN6aFRoVjErWFdZcDZyamQ1SlcxemJWV0VrTE54RTdHSlRoRVVHM3N6Z0JWR1A3cFNXVFVUc3FYCm5MUmJ3SE9vcTdoSHdnPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQotLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJRllEQ0NCRWlnQXdJQkFnSVFRQUYzSVRmVTZVSzQ3bmFxUEdRS3R6QU5CZ2txaGtpRzl3MEJBUXNGQURBLwpNU1F3SWdZRFZRUUtFeHRFYVdkcGRHRnNJRk5wWjI1aGRIVnlaU0JVY25WemRDQkRieTR4RnpBVkJnTlZCQU1UCkRrUlRWQ0JTYjI5MElFTkJJRmd6TUI0WERUSXhNREV5TURFNU1UUXdNMW9YRFRJME1Ea3pNREU0TVRRd00xb3cKVHpFTE1Ba0dBMVVFQmhNQ1ZWTXhLVEFuQmdOVkJBb1RJRWx1ZEdWeWJtVjBJRk5sWTNWeWFYUjVJRkpsYzJWaApjbU5vSUVkeWIzVndNUlV3RXdZRFZRUURFd3hKVTFKSElGSnZiM1FnV0RFd2dnSWlNQTBHQ1NxR1NJYjNEUUVCCkFRVUFBNElDRHdBd2dnSUtBb0lDQVFDdDZDUno5QlEzODV1ZUsxY29ISWUrM0xmZk9KQ01ianptVjZCNDkzWEMKb3Y3MWFtNzJBRThvMjk1b2hteEVrN2F4WS8wVUVtdS9IOUxxTVpzaGZ0RXpQTHBJOWQxNTM3TzQveEx4SVpwTAp3WXFHY1dsS1ptWnNqMzQ4Y0wrdEtTSUc4K1RBNW9DdTRrdVB0NWwrbEFPZjAwZVhmSmxJSTFQb09LNVBDbStECkx0RkpWNHlBZExiYUw5QTRqWHNEY0NFYmRmSXdQUHFQcnQzYVk2dnJGay9DamhGTGZzOEw2UCsxZHk3MHNudEsKNEV3U0pReHdqUU1wb09GVEpPd1QyZTRadnhDelNvdy9pYU5oVWQ2c2h3ZVU5R054N0M3aWIxdVlnZUdKWERSNQpiSGJ2TzVCaWVlYmJwSm92SnNYUUVPRU8zdGtRamhiN3QvZW85OGZsQWdlWWp6WUlsZWZpTjVZTk5uV2UrdzV5CnNSMmJ2QVA1U1FYWWdkMEZ0Q3JXUWVtc0FYYVZDZy9ZMzlXOUVoODFMeWdYYk5LWXdhZ0paSGR1UnplNnpxeFoKWG1pZGYzTFdpY1VHUVNrK1dUN2RKdlVreVJHbldxTk1RQjlHb1ptMXB6cFJib1k3bm4xeXB4SUZlRm50UGxGNApGUXNEajQzUUx3V3lQbnRLSEV0ekJSTDh4dXJnVUJOOFE1TjBzOHAwNTQ0ZkFRalFNTlJiY1RhMEI3ckJNREJjClNMZUNPNWltZldDS29xTXBnc3k2dllNRUc2S0RBMEdoMWdYeEc4SzI4S2g4aGp0R3FFZ3FpTngybW5hL0gycWwKUFJtUDZ6anpaTjdJS3cwS0tQLzMyK0lWUXRRaTBDZGQ0WG4rR09kd2lLMU81dG1MT3NiZEoxRnUvN3hrOVRORApUd0lEQVFBQm80SUJSakNDQVVJd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBT0JnTlZIUThCQWY4RUJBTUNBUVl3ClN3WUlLd1lCQlFVSEFRRUVQekE5TURzR0NDc0dBUVVGQnpBQ2hpOW9kSFJ3T2k4dllYQndjeTVwWkdWdWRISjEKYzNRdVkyOXRMM0p2YjNSekwyUnpkSEp2YjNSallYZ3pMbkEzWXpBZkJnTlZIU01FR0RBV2dCVEVwN0drZXl4eAordHZoUzVCMS84UVZZSVdKRURCVUJnTlZIU0FFVFRCTE1BZ0dCbWVCREFFQ0FUQS9CZ3NyQmdFRUFZTGZFd0VCCkFUQXdNQzRHQ0NzR0FRVUZCd0lCRmlKb2RIUndPaTh2WTNCekxuSnZiM1F0ZURFdWJHVjBjMlZ1WTNKNWNIUXUKYjNKbk1Ed0dBMVVkSHdRMU1ETXdNYUF2b0MyR0syaDBkSEE2THk5amNtd3VhV1JsYm5SeWRYTjBMbU52YlM5RQpVMVJTVDA5VVEwRllNME5TVEM1amNtd3dIUVlEVlIwT0JCWUVGSG0wV2VaN3R1WGtBWE9BQ0lqSUdsajI2WnR1Ck1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQUtjd0JzbG03L0RsTFFydDJNNTFvR3JTK280NCsveVFvREZWREMKNVd4Q3UyK2I5TFJQd2tTSUNIWE02d2ViRkdKdWVON3NKN281WFBXaW9XNVdsSEFRVTdHNzVLL1Fvc01yQWRTVwo5TVVnTlRQNTJHRTI0SEdOdExpMXFvSkZsY0R5cVNNbzU5YWh5MmNJMnFCRExLb2JreC9KM3ZXcmFWMFQ5VnVHCldDTEtUVlhrY0dkdHdsZkZSamxCejRwWWcxaHRtZjVYNkRZTzhBNGpxdjJJbDlEalhBNlVTYlcxRnpYU0xyOU8KaGU4WTRJV1M2d1k3YkNrakNXRGNSUUpNRWhnNzZmc08zdHhFK0ZpWXJ1cTlSVVdoaUYxbXl2NFE2VytDeUJGQwpEZnZwN09PR0FONmRFT000K3FSOXNkam9TWUtFQnBzcjZHdFBBUXc0ZHk3NTNlYzUKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  tls.key: >-
    LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRQ3g5OWhTeVpQbWNQY0QKY1QrTXpaMHVhN1o1d2RhNHkyeG5zQkF0TDFvbzF0dlZoN2R2MHF6cVhLUVNxWHRpR1lGU25FODRFOTRCOGxzNApIYXordEp5bFJ2NjlRQUNoOGRKNUt2YW13NklaYWsxTFFraVZsNm5yYUlUdWE5VWkxL3R4cE84aVUvaTExNG5vCnFKTlk2YlI4UkFoaVJCRHZzUzVMWUYrVncyTHdtZExNdTdGZTQzbVByS2k4T3pINmNXWFg1QytvUy9PODVWcUQKTE1yeVhneXlzZ28wU2NOUU00bUNHVnlzYW5IRjFnTDdlT1Zla2lKUFduaXJnM1AyRzBXUXBudG9OMnZyQ1RvNApkbmRaUEFLUERDQXlLcEtFU21lb3huWU5NUGdIOU8vellkcmd6bi8rTWxNTGs3T2N6UHlHTWdpTElDM3k4NFB3CnlLMXdKekVaQWdNQkFBRUNnZ0VCQUpTZkQrNkRISnBUT0ZXTm02NndmMVVtNnFwZnNEdCsxamI1RjJsRXBCeDYKNGZjK2NYaFhEY1JpUFRyQWdxTjMvVUhKKzNZdlVUVjYrYWF4VWFrYmw3Mkd2bkc1STA0YXJ0UTFodW5aY21PYgpISlYrOHpMS0IwTHFkQ2pQc0p4NmxpZGZ2N3lCTjdCVUlYMUVXbGprUXErTCtSeG5EMlc4SjVjWEVudjFRWWorCjVsdkN4WFEvMjZOTllaL1pYKy8vQUUxNXJBc0NKN3doa2dmSlNNK3Y5eFlwSjgyQnZOaEFBK1A1Ly9uZHFTQXoKWUh3bk5ScTdaNmtGZDFvcFlLQU1mb25XKzlmWHd1Uk5pdGVwOEJiWXhiY1p3VGRjVmY1Q0dPM3g4Wmh5L3EyVQp0SXcreDExUmFGK0ZBRnNEWnEwTjVnQzRhd29vZHlSSEZ4bjRNbStoUE9rQ2dZRUF3SG0rZE5nUmpsN2dGNjJRCkh3ZXpRcVdHSEJaSWxxUzdMbjBwTTNNelNyNVFtY3BySkp1TE9iR0VnS0tXMlhDYUFTMXNkLzNhT1pabER1QWEKTXlldFhxY0I5dDIxajJVUEgySkFwWnpHWG9ScjduNml5M3cvOEtrbUdkWk1TUm1vbkZzMWsrSnV4VmNPVThFQgpWOVFkUTZTODVCbHpkS1VKQzJUa2p3UmR1S01DZ1lFQTdMUmVvRFY3T2UrTEI4a1A4TmUveGZHWDdod1ZPQW12CnVUR1ZZd3hJcHhPNlo4M0loL2ExanMxWVhHRm1pZnVsL3dUdmxISFRpcjF4bTlPeVB5VFR0YnRXYWdqUHFlVEoKdStwRjZUdDM4dWVtVzR6bjFubEliVW12bkd6b0NWZ3BrbkpDbm5HaUszMGU3V251VFJOaUx0RUUwOEVjUnIxRwo1RmxEMk1oNlh4TUNnWUEweDIyTmRzNWhudXlPTVo3S2szNzVjSkEwMVh0MEs1blVacWZNbnZOYXRKTS9pTDBXCm5ieHd4cGZSK2tPcFBuSk1qbHNuRUNvdURtcUp5TFFHZ1FQT1o3ZG5MV2FpK3BCS0I5UTRWYVFqdU9ZcjBQZnQKR3BZaDlSQW9sNVgxbVo2ZHVYa1lvMGZDdjF1RFpmSnJWaFBzUDVrNFp5NDh0eUNpeWpqT2F1RVVSd0tCZ1FDbQpHQzdxRm4wZ2UwRkF0a3AwUXNBendzSk1kL0kvdnpSS0xFdmFFODJMUjZHZW8xeWFZM2lrK3R5TS9sKzRaUmZtCjZleS9hbHY1VjlPM2Q0WDFIdjliMzFmVTBkZitMQ2VPcitaY3Nia0tmcGhTVjM1N0ZlSEhwbFFPM0xDNWxkNmQKLzRWVnJ3RVBxUjJobEpwK0JTTDVIUHhaSm9HVDljOGYvcTlJRiswZWR3S0JnSElrYXZ1S054YUNjbkdXWkFBOApWUWVLSEVtWngrQndXZmdUN0c2YlBiTVlSVWZ4UkxWMzR4YmkxNm8xTkJwMGhaV0RaejVXZkJFMlZmek9IbndBCjNxaVI0aW5SMHJHdStWVjd1bnRVeTl4bUtWY3AzdkhyQUtGcHMvSlJqbktVWmJyU09CVlVmQTlMTlhIVHNTYkUKZFBWNWZ1WCtNem1PLytRWVdGMGx2V3RQCi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
{{- end }}
